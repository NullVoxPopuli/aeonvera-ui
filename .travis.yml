---
language: node_js
env:
  - TRAVIS_NODE_VERSION="5.10.1"
  - TRAVIS_NODE_VERSION="5.11.0"

sudo: false

addons:
  code_climate:
    repo_token: a267a66fea342c45c32ff52fb93592b70d9a2919ef2953b9261006aaa8e38348

cache:
  directories:
    - node_modules

before_install:
  - export PATH=/usr/local/phantomjs-2.0.0/bin:$PATH
  - "npm config set spin false"
  - "npm install -g npm@^2"

install:
  - rm -rf ~/.nvm && git clone https://github.com/creationix/nvm.git ~/.nvm && (cd ~/.nvm && git checkout `git describe --abbrev=0 --tags`) && source ~/.nvm/nvm.sh && nvm install $TRAVIS_NODE_VERSION
  - npm install -g bower
  - npm install -g jscs
  - npm install -g jshint
  - npm install -g codeclimate-test-reporter
  - npm install
  - bower install

before_script:
  - "export DISPLAY=:99.0"
  - "sh -e /etc/init.d/xvfb start"
  - sleep 3 # give xvfb some time to start

script:
  - npm run ci

after_script:
  - codeclimate-test-reporter < lcov.dat

notifications:
  email: false
